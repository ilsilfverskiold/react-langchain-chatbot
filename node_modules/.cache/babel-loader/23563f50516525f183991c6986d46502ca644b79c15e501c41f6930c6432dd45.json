{"ast":null,"code":"import { Client } from \"langsmith\";\nimport { getEnvironmentVariable, getRuntimeEnvironment } from \"../../util/env.js\";\nimport { BaseTracer } from \"./tracer.js\";\nexport class LangChainTracer extends BaseTracer {\n  constructor(fields = {}) {\n    super(fields);\n    Object.defineProperty(this, \"name\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: \"langchain_tracer\"\n    });\n    Object.defineProperty(this, \"projectName\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"exampleId\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, \"client\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    const {\n      exampleId,\n      projectName,\n      client\n    } = fields;\n    this.projectName = projectName ?? getEnvironmentVariable(\"LANGCHAIN_PROJECT\") ?? getEnvironmentVariable(\"LANGCHAIN_SESSION\");\n    this.exampleId = exampleId;\n    this.client = client ?? new Client({});\n  }\n  async _convertToCreate(run, example_id = undefined) {\n    return {\n      ...run,\n      extra: {\n        ...run.extra,\n        runtime: await getRuntimeEnvironment()\n      },\n      child_runs: undefined,\n      session_name: this.projectName,\n      reference_example_id: run.parent_run_id ? undefined : example_id\n    };\n  }\n  async persistRun(_run) {}\n  async _persistRunSingle(run) {\n    const persistedRun = await this._convertToCreate(run, this.exampleId);\n    await this.client.createRun(persistedRun);\n  }\n  async _updateRunSingle(run) {\n    const runUpdate = {\n      end_time: run.end_time,\n      error: run.error,\n      outputs: run.outputs,\n      events: run.events\n    };\n    await this.client.updateRun(run.id, runUpdate);\n  }\n  async onRetrieverStart(run) {\n    await this._persistRunSingle(run);\n  }\n  async onRetrieverEnd(run) {\n    await this._updateRunSingle(run);\n  }\n  async onRetrieverError(run) {\n    await this._updateRunSingle(run);\n  }\n  async onLLMStart(run) {\n    await this._persistRunSingle(run);\n  }\n  async onLLMEnd(run) {\n    await this._updateRunSingle(run);\n  }\n  async onLLMError(run) {\n    await this._updateRunSingle(run);\n  }\n  async onChainStart(run) {\n    await this._persistRunSingle(run);\n  }\n  async onChainEnd(run) {\n    await this._updateRunSingle(run);\n  }\n  async onChainError(run) {\n    await this._updateRunSingle(run);\n  }\n  async onToolStart(run) {\n    await this._persistRunSingle(run);\n  }\n  async onToolEnd(run) {\n    await this._updateRunSingle(run);\n  }\n  async onToolError(run) {\n    await this._updateRunSingle(run);\n  }\n}","map":{"version":3,"names":["Client","getEnvironmentVariable","getRuntimeEnvironment","BaseTracer","LangChainTracer","constructor","fields","Object","defineProperty","enumerable","configurable","writable","value","exampleId","projectName","client","_convertToCreate","run","example_id","undefined","extra","runtime","child_runs","session_name","reference_example_id","parent_run_id","persistRun","_run","_persistRunSingle","persistedRun","createRun","_updateRunSingle","runUpdate","end_time","error","outputs","events","updateRun","id","onRetrieverStart","onRetrieverEnd","onRetrieverError","onLLMStart","onLLMEnd","onLLMError","onChainStart","onChainEnd","onChainError","onToolStart","onToolEnd","onToolError"],"sources":["/Users/idasilfverskiold/gptSandbox/reactlangchain/sandbox/node_modules/langchain/dist/callbacks/handlers/tracer_langchain.js"],"sourcesContent":["import { Client } from \"langsmith\";\nimport { getEnvironmentVariable, getRuntimeEnvironment, } from \"../../util/env.js\";\nimport { BaseTracer } from \"./tracer.js\";\nexport class LangChainTracer extends BaseTracer {\n    constructor(fields = {}) {\n        super(fields);\n        Object.defineProperty(this, \"name\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: \"langchain_tracer\"\n        });\n        Object.defineProperty(this, \"projectName\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"exampleId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"client\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        const { exampleId, projectName, client } = fields;\n        this.projectName =\n            projectName ??\n                getEnvironmentVariable(\"LANGCHAIN_PROJECT\") ??\n                getEnvironmentVariable(\"LANGCHAIN_SESSION\");\n        this.exampleId = exampleId;\n        this.client = client ?? new Client({});\n    }\n    async _convertToCreate(run, example_id = undefined) {\n        return {\n            ...run,\n            extra: {\n                ...run.extra,\n                runtime: await getRuntimeEnvironment(),\n            },\n            child_runs: undefined,\n            session_name: this.projectName,\n            reference_example_id: run.parent_run_id ? undefined : example_id,\n        };\n    }\n    async persistRun(_run) { }\n    async _persistRunSingle(run) {\n        const persistedRun = await this._convertToCreate(run, this.exampleId);\n        await this.client.createRun(persistedRun);\n    }\n    async _updateRunSingle(run) {\n        const runUpdate = {\n            end_time: run.end_time,\n            error: run.error,\n            outputs: run.outputs,\n            events: run.events,\n        };\n        await this.client.updateRun(run.id, runUpdate);\n    }\n    async onRetrieverStart(run) {\n        await this._persistRunSingle(run);\n    }\n    async onRetrieverEnd(run) {\n        await this._updateRunSingle(run);\n    }\n    async onRetrieverError(run) {\n        await this._updateRunSingle(run);\n    }\n    async onLLMStart(run) {\n        await this._persistRunSingle(run);\n    }\n    async onLLMEnd(run) {\n        await this._updateRunSingle(run);\n    }\n    async onLLMError(run) {\n        await this._updateRunSingle(run);\n    }\n    async onChainStart(run) {\n        await this._persistRunSingle(run);\n    }\n    async onChainEnd(run) {\n        await this._updateRunSingle(run);\n    }\n    async onChainError(run) {\n        await this._updateRunSingle(run);\n    }\n    async onToolStart(run) {\n        await this._persistRunSingle(run);\n    }\n    async onToolEnd(run) {\n        await this._updateRunSingle(run);\n    }\n    async onToolError(run) {\n        await this._updateRunSingle(run);\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}